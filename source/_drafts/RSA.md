---
title: RSA
tags:
---
## 第一步 生成秘钥对

## 1 随机找两个质数P和Q，并计算n

比如 P = 67 ，Q = 71。计算他们的乘积 n = P * Q = 4757 ，转化为二进为 1001010010101，该加密算法即为 13 位，实际算法中是 1024 位 或 2048 位，位数越长，算法越难被破解（即P和Q的值要尽可能大）。

> P=67
>
> Q=71
>
> n=4757

## 2 计算m

这里要引入欧拉函数的概念：欧拉函数φ(n) 表示在小于等于 n 的正整数之中，与 n 构成互质关系的数的个数。

e.g. 在 1 到 8 之中，与 8 形成互质关系的是1、3、5、7，所以 φ(n) = 4

欧拉函数有这样一个性质：当  n = P * Q，P 与 Q 均为质数，则 φ(n) = φ(P * Q)= φ(P - 1)*φ(Q - 1) = (P - 1)*(Q - 1) 。 

令m=φ(n)，则在本例中 m=φ(n) = 66 * 70 = 4620

> P=67
>
> Q=71
>
> n=4757
>
> m=4620

## 3 随机选择一个整数 e

整数e的条件为1< e < m，且 e 与 m 互质。

我们称公约数只有 1 的两个整数为互质整数，这里我们随机选择 e = 101

请注意不要选择 4619，如果选这个，则公钥和私钥将变得相同。

> P=67
>
> Q=71
>
> n=4757
>
> m=4620
>
> e=101

## 4 找一个整数d

条件是(e * d ) % m = 1。 该方程可以转换为(e*d+1) / m = y，其中y为整数，于是变成一个未知数为d和y的二元一次方程。这个方程可以用["扩展欧几里得算法"](http://zh.wikipedia.org/wiki/扩展欧几里得算法)求解，此处省略具体过程。总之，爱丽丝算出一组整数解为 (x,y)=(2753,-15)，即 d=2753。



**第六步，将n和e封装成公钥，n和d封装成私钥。**

在爱丽丝的例子中，n=3233，e=17，d=2753，所以公钥就是 (3233,17)，私钥就是（3233, 2753）。



七、RSA算法的可靠性

回顾上面的密钥生成步骤，一共出现六个数字：

　　p
　　q
　　n
　　φ(n)
　　e
　　d

这六个数字之中，公钥用到了两个（n和e），其余四个数字都是不公开的。其中最关键的是d，因为n和d组成了私钥，一旦d泄漏，就等于私钥泄漏。

那么，有无可能在已知n和e的情况下，推导出d？

　　（1）ed≡1 (mod φ(n))。只有知道e和φ(n)，才能算出d。

　　（2）φ(n)=(p-1)(q-1)。只有知道p和q，才能算出φ(n)。

　　（3）n=pq。只有将n因数分解，才能算出p和q。

结论：如果n可以被因数分解，d就可以算出，也就意味着私钥被破解。